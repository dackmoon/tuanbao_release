<!--pages/memo/memo.wxml-->
<view class="memo-container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="memo-header">
    <!-- æœç´¢æ¡† -->
    <view class="search-container">
      <view class="search-box">
        <input 
          class="search-input" 
          placeholder="æœç´¢å¤‡å¿˜å½•" 
          value="{{searchValue}}"
          bindinput="onSearchInput"
          confirm-type="search"
          bindconfirm="performSearch"
        />
        <view class="search-btn" bindtap="performSearch">
          <image class="search-icon" src="/images/icons/search.png" mode="aspectFit"></image>
        </view>
      </view>
    </view>
    
    <!-- ç¼–è¾‘æŒ‰é’® -->
    <view class="edit-btn" bindtap="toggleEditMode">
      <text class="edit-text">{{isEditMode ? 'å®Œæˆ' : 'ç¼–è¾‘'}}</text>
    </view>
  </view>

  <!-- å¤‡å¿˜å½•åˆ—è¡¨ -->
  <scroll-view class="memo-list" scroll-y="true" enhanced="true">
    <view wx:if="{{memoList.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ“</view>
      <view class="empty-text">æš‚æ— å¤‡å¿˜å½•</view>
      <view class="empty-hint">ç‚¹å‡»å³ä¸‹è§’ + å·æ·»åŠ ç¬¬ä¸€ä¸ªå¤‡å¿˜å½•</view>
    </view>
    
    <view wx:else>
      <view 
        wx:for="{{memoList}}" 
        wx:key="_id" 
        class="memo-item {{isEditMode ? 'edit-mode' : ''}} {{selectedMemos.indexOf(item._id) > -1 ? 'selected' : ''}}"
        bindtap="navigateToEdit"
        data-id="{{item._id}}"
      >
        <!-- é€‰æ‹©æ¡†ï¼ˆç¼–è¾‘æ¨¡å¼ä¸‹æ˜¾ç¤ºï¼‰ -->
        <view wx:if="{{isEditMode}}" class="memo-checkbox">
          <view class="checkbox {{selectedMemos.indexOf(item._id) > -1 ? 'checked' : ''}}">
            <text wx:if="{{selectedMemos.indexOf(item._id) > -1}}" class="check-icon">âœ“</text>
          </view>
        </view>
        
        <!-- å¤‡å¿˜å½•å†…å®¹ -->
        <view class="memo-content">
          <!-- ç¬¬ä¸€è¡Œï¼šæ ‡ç­¾ + æ ‡é¢˜ -->
          <view class="memo-header-line">
            <view 
              class="memo-tag-circle" 
              style="background-color: {{tagColors[item.tag]}}"
            ></view>
            <text class="memo-title">{{item.title}}</text>
          </view>
          
          <!-- ç¬¬äºŒè¡Œï¼šæ›´æ–°æ—¶é—´ -->
          <view class="memo-time-line">
            <text class="memo-time">{{formatUpdateTime(item.updateTime)}}</text>
          </view>
          
          <!-- ç¬¬ä¸‰è¡Œï¼šå†…å®¹é¢„è§ˆ -->
          <view class="memo-preview-line">
            <text class="memo-preview">{{item.content}}</text>
          </view>
        </view>
        
        <!-- å³ç®­å¤´ï¼ˆéç¼–è¾‘æ¨¡å¼ä¸‹æ˜¾ç¤ºï¼‰ -->
        <view wx:if="{{!isEditMode}}" class="memo-arrow">
          <text class="arrow-icon">â€º</text>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- åº•éƒ¨åˆ é™¤æŒ‰é’®ï¼ˆç¼–è¾‘æ¨¡å¼ä¸‹æ˜¾ç¤ºï¼‰ -->
  <view wx:if="{{isEditMode}}" class="bottom-actions">
    <view 
      class="delete-btn {{selectedMemos.length === 0 ? 'disabled' : ''}}"
      bindtap="deleteSelectedMemos"
    >
      <text class="delete-icon">ğŸ—‘ï¸</text>
      <text class="delete-text">åˆ é™¤ ({{selectedMemos.length}})</text>
    </view>
  </view>

  <!-- æ‚¬æµ®æ·»åŠ æŒ‰é’® -->
  <view wx:if="{{!isEditMode}}" class="add-btn" bindtap="navigateToAdd">
    <text class="add-icon">+</text>
  </view>
</view>