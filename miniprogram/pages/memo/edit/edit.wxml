<!--pages/memo/edit/edit.wxml-->
<view class="edit-container">
  <!-- 标题与标签行 -->
  <view class="header-section">
    <!-- 标题输入 -->
    <view class="title-input-container">
      <input 
        class="title-input" 
        placeholder="请输入标题" 
        value="{{title}}"
        bindinput="onTitleInput"
        maxlength="50"
        focus="{{!isEdit}}"
      />
      <view wx:if="{{title.trim() === ''}}" class="required-indicator">*</view>
    </view>
    
    <!-- 标签选择 -->
    <view class="tag-section">
      <text class="tag-text-label">标签</text>
      <view class="tag-selector" bindtap="showTagSelector">
        <view 
          class="selected-tag {{selectedTag ? '' : 'tag-placeholder'}}" 
          style="{{selectedTagColor ? 'background-color: ' + selectedTagColor : ''}}"
        ></view>
        <view class="selector-arrow">▼</view>
        <view wx:if="{{selectedTag === ''}}" class="required-indicator">*</view>
      </view>
    </view>
  </view>

  <!-- 内容输入区域 -->
  <view class="content-section">
    <textarea 
      class="content-textarea"
      placeholder="请输入备忘录内容..."
      value="{{content}}"
      bindinput="onContentInput"
      auto-height
      maxlength="2000"
      show-confirm-bar="{{false}}"
    ></textarea>
  </view>

  <!-- 操作按钮 -->
  <view class="action-buttons">
    <view class="cancel-btn" bindtap="cancelEdit">
      <text class="btn-text">取消</text>
    </view>
    <view 
      class="save-btn {{canSave ? '' : 'disabled'}}" 
      bindtap="saveMemo"
    >
      <text class="btn-text">保存</text>
    </view>
  </view>

  <!-- 标签选择器弹窗 -->
  <view wx:if="{{showTagPicker}}" class="tag-picker-mask" bindtap="hideTagSelector">
    <view class="tag-picker-container" catchtap="stopPropagation">
      <view class="picker-header">
        <text class="picker-title">选择标签</text>
        <view class="picker-close" bindtap="hideTagSelector">×</view>
      </view>
      
      <view class="tag-options">
        <view 
          wx:for="{{tagOptions}}" 
          wx:key="value"
          class="tag-option {{selectedTag === item.value ? 'selected' : ''}}"
          bindtap="selectTag"
          data-tag="{{item.value}}"
        >
          <view 
            class="tag-color-dot" 
            style="background-color: {{item.color}}"
          ></view>
          <text class="tag-option-label">{{item.label}}</text>
          <view wx:if="{{selectedTag === item.value}}" class="selected-icon">✓</view>
        </view>
      </view>
    </view>
  </view>
</view>